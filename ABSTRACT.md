The authors of the **MVTec Logical Constraints Anomaly Detection (MVTec LOCO AD)** dataset introduce a benchmark corpus aimed at addressing the unsupervised detection and localization of anomalies in natural images. This challenging problem involves the identification of anomalies that can manifest in diverse ways. To create an effective benchmark, the authors assert that a dataset should encompass representative examples of various anomaly types. They observe that existing datasets tend to focus on local structural anomalies, such as scratches or dents, while overlooking anomalies involving violations of logical constraints, such as objects appearing in invalid locations. To bridge this gap, the authors contribute a novel dataset based on industrial inspection contexts. This dataset is meticulously designed to provide a balanced representation of both structural and logical anomalies. The authors offer pixel-precise ground truth annotations for each anomalous region and introduce an evaluation metric tailored to address localization ambiguities that can arise with logical anomalies. Additionally, they present a new algorithm that outperforms existing approaches in jointly detecting structural and logical anomalies. This algorithm comprises local and global network branches, each with distinct responsibilities.

The authors highlight that existing datasets often focus solely on structural anomalies within industrial inspection scenarios. They note the scarcity of datasets that include both structural and logical anomalies, which are prevalent in real-world manufacturing processes. In response, the authors introduce a dataset inspired by industrial inspection scenarios, carefully balancing the presence of logical and structural anomalies.

<img src="https://github.com/supervisely/supervisely/assets/78355358/c99da33b-dd46-482b-b986-dc5f31f88a73" alt="image" width="800">

This new dataset, termed MVTec LOCO AD, is composed of five object categories relevant to industrial inspection contexts. The authors selected these objects to closely mimic real-world applications. The dataset includes 1772 *train* images, 304 *validation* images, and 1568 *test* images. The authors provide sample images for each category and stress that the training and validation sets exclusively contain anomaly-free images. The test set encompasses both anomaly-free images and images featuring diverse types of logical and structural anomalies. The authors emphasize the independence of the three sets from one another, ensuring distinct physical objects and no overlap between sets.

Each category in the dataset adheres to specific logical constraints, and the authors detail the characteristics of each category and the logical rules governing them. The authors illustrate logical defects and provide examples of how violations of these constraints manifest within the dataset's images.

| Category            | # Training images | # Validation images | # Test images (anomaly-free) | # Test images (structural) | # Test images (logical) | # Defect types | Image width | Image height |
| ------------------- | ----------------- | ------------------- | ---------------------------- | -------------------------- | ----------------------- | -------------- | ----------- | ------------ |
| Breakfast Box       | 351               | 62                  | 102                          | 90                         | 83                      | 22             | 1600        | 1280         |
| Screw Bag           | 360               | 60                  | 122                          | 82                         | 137                     | 20             | 1600        | 1100         |
| Pushpins            | 372               | 69                  | 138                          | 81                         | 91                      | 8              | 1700        | 1000         |
| Splicing Connectors | 354               | 59                  | 119                          | 85                         | 108                     | 21             | 1700        | 850          |
| Juice Bottle        | 335               | 54                  | 94                           | 94                         | 142                     | 18             | 800         | 1600         |
| Total               | 1772              | 304                 | 575                          | 432                        | 561                     | 89             | –          | –           |

For model evaluation purposes, authors selected suitable saturation thresholds for each of the 89 individual defect types that occur in our dataset.

<img src="https://github.com/supervisely/supervisely/assets/78355358/f1e25f20-a981-4d8e-85e0-9cc90d73c6d8" alt="image" width="800">

For an annotated anomaly A, a ***saturation_threshold*** s is selected. Once the overlap of the predicted region with the ground truth A exceeds s, the anomaly segmentation task is considered as solved. A ***relative_saturation***``=True` indicates that the whole area of the ground truth region is taken as the saturation threshold. In particular, this is the case for all structural anomalies in our dataset.
